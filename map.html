<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <title>Naver Map</title>
    <!-- ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œ -->
    <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=<?= clientId ?>"></script>
    <style>
        /* ì§€ë„ í™”ë©´ ìŠ¤íƒ€ì¼ */
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #f0f0f0; }
        #map { width: 100%; height: 100%; }
        
        /* ì—ëŸ¬ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .error-msg {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            color: #666;
            font-family: sans-serif;
            font-size: 14px;
            text-align: center;
            padding: 20px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
<!-- ì§€ë„ í‘œì‹œ ì˜ì—­ -->
<div id="map"></div>

<script>
    // ì„œë²„(Code.gs)ì—ì„œ ì „ë‹¬ëœ ê°’ ë°›ê¸°
    var lat = <?= lat || 'null' ?>;
    var lng = <?= lng || 'null' ?>;
    var clientId = "<?= clientId ?>"; 

    // 1. Client ID ì²´í¬
    if (!clientId || clientId === "null" || clientId === "undefined" || clientId === "") {
        document.getElementById('map').innerHTML = 
            "<div class='error-msg'>âš ï¸ <b>ì„¤ì • ì˜¤ë¥˜</b><br>Client IDê°€ ì—†ìŠµë‹ˆë‹¤.<br>ìŠ¤í¬ë¦½íŠ¸ ì†ì„±ì„ í™•ì¸í•´ì£¼ì„¸ìš”.</div>";
    } 
    // 2. ì¢Œí‘œ ì²´í¬
    else if (lat === null || lng === null) {
        document.getElementById('map').innerHTML = 
            "<div class='error-msg'>ğŸ“ <b>ìœ„ì¹˜ ì •ë³´ ì—†ìŒ</b><br>ì¢Œí‘œê°€ ì „ë‹¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</div>";
    } 
    // 3. ì§€ë„ ìƒì„±
    else {
        try {
            var position = new naver.maps.LatLng(lat, lng);
            var map = new naver.maps.Map('map', {
                center: position,
                zoom: 16,
                scaleControl: false,
                logoControl: false,
                mapDataControl: false,
                zoomControl: true,
                zoomControlOptions: {
                    position: naver.maps.Position.TOP_RIGHT
                }
            });
            var marker = new naver.maps.Marker({ position: position, map: map });

        } catch (e) {
            // ë„¤ì´ë²„ API ë¡œë“œ ì‹¤íŒ¨ ì‹œ
            document.getElementById('map').innerHTML = 
                "<div class='error-msg'>ğŸš« <b>ì§€ë„ ë¡œë“œ ì‹¤íŒ¨</b><br>" + e.message + "<br><br>ë„¤ì´ë²„ ì½˜ì†”ì— ë„ë©”ì¸ì´ ë“±ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.</div>";
        }
    }
</script>
</body>
</html>